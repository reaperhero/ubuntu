
Redis 是什么？它有什么主要特点？

答案： Redis (Remote Dictionary Server) 是一个基于内存的 键值数据库。它通常被用作数据库、缓存、消息中间件。

主要特点：

基于内存： 数据存储在内存中，读写速度极快（10W+ QPS）。

场景： String（缓存、计数器）、Hash（对象属性）、List（消息队列、排行榜）、Set（标签、共同好友）、Zset（延时队列、排行榜）。

持久化： 支持 RDB 和 AOF 两种方式将内存数据持久化到磁盘，防止数据丢失。

高可用和分布式： 通过 Redis Sentinel 实现高可用，通过 Redis Cluster 实现分布式存储。

单线程模型： 处理命令的核心模块是单线程的，避免了多线程的上下文切换和竞争条件，简化了实现。





- Redis 的持久化机制 RDB 和 AOF 有什么区别？各自的优缺点？

RDB (Redis Database):

原理： 在指定的时间间隔内，生成内存数据的快照（Snapshot）文件（.rdb）。

优点：

文件紧凑，恢复速度快。

适合做灾难恢复和冷备份。

最大化Redis性能：父进程唯一的工作就是fork一个子进程，由子进程完成持久化。

缺点：

数据安全性低： 容易丢失最后一次快照之后的数据（宕机时）。

Fork 子进程时，如果数据量太大，可能会导致服务暂停几毫秒甚至几秒。




AOF (Append Only File):

原理： 记录写操作命令，以日志的形式追加到文件末尾。支持不同的同步策略（always, everysec, no）。

优点：

数据安全性高： 一般配置为每秒同步一次（appendfsync everysec），最多丢失1秒数据。

AOF 文件易于理解和解析。

缺点：

文件体积大，恢复速度慢。

对性能影响稍大，但通常仍然很高。

生产环境建议： 通常同时开启 RDB 和 AOF。用 AOF 保证数据不丢失，用 RDB 做不同程度的冷备。Redis 4.0 后支持混合持久化（AOF 文件包含RDB头和增量AOF日志），兼顾速度和数据安全。




什么是缓存穿透、缓存击穿、缓存雪崩？如何解决？

缓存穿透： 查询一个一定不存在的数据（如id为负）。请求穿透缓存直接打到数据库。

解决： ① 接口校验拦截非法请求；② 缓存空值（null）并设置短过期时间；③ 布隆过滤器快速判断key是否存在。

缓存击穿： 某个热点key过期的瞬间，大量请求直接打到数据库。

解决： ① 永不过期（逻辑过期）；② 互斥锁：第一个请求负责重建缓存，其他请求等待。

缓存雪崩： 大量key在同一时间过期或 Redis 实例宕机，导致所有请求打到数据库。

解决： ① 差异化过期时间（加随机值）；② Redis 高可用（集群）；③ 服务降级和熔断。



Redis 如何实现分布式锁？要注意什么问题？

基础命令： SET lock_key unique_value NX PX 30000
NX：只在键不存在时设置（获取锁）。
PX 30000：设置锁的过期时间为30000毫秒（防止客户端崩溃导致锁无法释放）。
unique_value：必须是一个唯一值（如UUID），用于安全释放锁。

释放锁： 使用 Lua 脚本保证原子性，先检查 unique_value 是否匹配，再删除
if redis.call("get", KEYS[1]) == ARGV[1] then
    return redis.call("del", KEYS[1])
else
    return 0
end