Dockerfile中 COPY 和 ADD 命令的区别？


多阶段构建

多阶段构建允许你在一个 Dockerfile 中使用多个 FROM 语句。每个 FROM 指令都可以使用不同的基础镜像，并开始一个新的构建阶段（Stage）。你可以有选择地将文件从一个阶段复制到另一个阶段，最终只保留你需要的部分在最终镜像中。


Docker 和虚拟机的本质区别是什么？

答案：虚拟机虚拟化硬件，需要完整的Guest OS，体积大启动慢。Docker容器共享主机内核，只包含应用和依赖库，轻量、快速。

如何优化 Docker 镜像大小？

答案：1) 使用小的基础镜像（Alpine）；2) 多阶段构建（multi-stage build）；3) 合并RUN指令，减少镜像层；4) .dockerignore 文件排除无关文件。



主控节点组件：

kube-apiserver： 集群的唯一入口，所有内外部的请求都必须通过它，是 RESTful API 前端。

etcd： 高可用的键值数据库，持久化存储整个集群的状态和配置数据，是集群的“大脑”。

kube-scheduler： 负责调度 Pods 到合适的工作节点上。它根据资源需求、策略、亲和性等条件做出决策。

kube-controller-manager： 运行着多种控制器的守护进程，这些控制器不断循环，确保集群的当前状态向期望状态收敛（例如，Node Controller, Replication Controller）。

cloud-controller-manager： 用于与底层云提供商（如 AWS, GCP, Azure）的 API 交互，管理节点、路由、负载均衡器等。



描述一下 Pod 的创建流程（Kubernetes）

答案：1) kubectl 向 API Server 提交 YAML；2) API Server 写入 etcd；3) Scheduler 发现未调度的 Pod，根据策略选择 Node，更新 etcd；4) 目标 Node 的 kubelet 监听到变化，调用容器运行时（Docker/containerd）拉取镜像并创建容器。

Service 和 Ingress 有什么区别？

答案：Service 是 L4 负载均衡，提供集群内部或外部通过ClusterIP/NodePort/LoadBalancer访问Pod的稳定端点。Ingress 是 L7 流量入口，提供基于HTTP/HTTPS主机名和路径的路由规则，需要Ingress Controller（如nginx-ingress）才能生效。

如何排查一个 Pod 一直处于 Pending 状态？

思路：kubectl describe pod <pod-name> -> 看 Events 部分。常见原因：1) 资源不足（CPU/Memory）；2) 没有匹配的节点（NodeSelector/Affinity/Taints）；3) 正在拉取镜像。



存活探针 (Liveness Probe) 和就绪探针 (Readiness Probe) 的区别？
答：

Liveness Probe： “我是否活着？” 用于判断容器是否运行正常。如果探测失败，kubelet 会重启容器。

Readiness Probe： “我是否准备好接收流量？” 用于判断容器是否已准备就绪接受服务请求。如果探测失败，Endpoint Controller 会从与该 Pod 匹配的所有 Service 的端点中移除该 Pod 的 IP


什么是 Operator？
答： Operator 是一种扩展 Kubernetes API 的模式，它使用自定义资源 (CRD) 和自定义控制器来管理和操作有状态应用。它将运维人员的管理知识（如备份、扩容、升级）编码成软件逻辑，实现复杂应用的自动化管理（例如，Etcd Operator, Prometheus Operator）


