# etcd command


```
etcdctl --endpoints="http://192.168.1.187:32327"  version 查询版本
etcdctl version: 3.4.9
API version: 3.4

etcdctl --endpoints "http://192.168.1.187:32327,http://192.168.1.187:32328,http://192.168.1.187:32329" --write-out="table" endpoint status   # endpoint可以是单个
+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |
+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
| http://192.168.1.187:32327 | cf1d15c5d194b5c9 |   3.4.4 |   19 MB |     false |      false |         4 |      51804 |              51804 |        |
| http://192.168.1.187:32328 | ade526d28b1f92f7 |   3.4.4 |   19 MB |     false |      false |         4 |      51804 |              51804 |        |
| http://192.168.1.187:32329 | d282ac2ce600c1ce |   3.4.4 |   19 MB |      true |      false |         4 |      51805 |              51805 |        |
+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+


etcdctl --endpoints "http://192.168.1.187:32327,http://192.168.1.187:32328,http://192.168.1.187:32329" endpoint health  --write-out="table"
+--------------------------+--------+--------------+-------+
|         ENDPOINT         | HEALTH |     TOOK     | ERROR |
+--------------------------+--------+--------------+-------+
| http://192.168.1.187:32328 |   true | 188.762056ms |       |
| http://192.168.1.187:32329 |   true | 198.299192ms |       |
| http://192.168.1.187:32327 |   true | 201.908276ms |       |
+--------------------------+--------+--------------+-------+


etcdctl --endpoints="http://122.112.218.250:32327" endpoint status --write-out="json"   # 查看版本 | egrep -o '"revision":[0-9]*'|egrep -o "[0-9]+"
[{"Endpoint":"http://122.112.218.250:32327","Status":{"header":{"cluster_id":10365418147648976999,"member_id":14924108679544616393,"revision":15558,"raft_term":2},"version":"3.4.4","dbSize":5775360,"leader":12530464223947363063,"raftIndex":15573,"raftTerm":2,"raftAppliedIndex":15573,"dbSizeInUse":5775360}}]


etcdctl --endpoints="http://119.3.137.149:32329" compact 版本数字 # 压缩版本

etcdctl --endpoints="http://119.3.137.149:32329" defrag

etcdctl --endpoints="http://119.3.137.149:32329" alarm list # 查看报警

etcdctl --endpoints="http://119.3.137.149:32329" alarm disarm # 取消警报
```

## 数据操作
```
etcdctl --endpoints="http://119.3.137.149:32329"  put foo "heer" # 添加数据
etcdctl --endpoints="http://119.3.137.149:32329"  put foo hello  # 更新数据
etcdctl --endpoints="http://119.3.137.149:32329"  --print-value-only get foo   # 查询数据

etcdctl --endpoints="http://119.3.137.149:32329"  get --from-key "" # 查询所有key和值
etcdctl --endpoints="http://119.3.137.149:32329"  del foo    # 删除key

etcdctl --endpoints="http://119.3.137.149:32329"  get / --prefix --keys-only    # /前缀查询
```


## 节点管理


```
etcdctl --endpoints="http://119.3.137.149:32327"  member list   # 查看节点
ade526d28b1f92f7, started, etcd1, http://etcd1:2380, http://etcd1:2379, false
cf1d15c5d194b5c9, started, etcd0, http://etcd0:2380, http://etcd0:2379, false
d282ac2ce600c1ce, started, etcd2, http://etcd2:2380, http://etcd2:2379, false


etcdctl --endpoints="http://192.168.1.40:2379"  member add m1 --peer-urls="http://192.168.1.187:2380"  # 先添加，再启动
```