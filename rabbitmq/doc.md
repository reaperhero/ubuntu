# RabbitMQ介绍

## 工作模式

- Work queues

两个消费端共同消费同一个队列中的消息，不用定义交换机

1. 一条消息只会被一个消费者接收；

2. rabbit采用轮询的方式将消息是平均发送给消费者的；

3. 消费者在处理完某条消息后，才会收到下一条消息


- Publish/Subscribe

每个消费者监听自己的队列，生产者将消息发给broker，由交换机将消息转发到绑定此交换机的每个队列，每个绑定交换机的队列都将接收到消息
使用生产者发送若干条消息，每条消息都转发到各各队列，每消费者都接收到了消息

- Routing

1. 每个消费者监听自己的队列，并且设置routingkey。

2. 生产者将消息发给交换机，由交换机根据routingkey来转发消息到指定的队列

生产者发送若干条消息，交换机根据routingkey转发消息到指定的队列。


- Topics

1. 每个消费者监听自己的队列，并且设置带统配符的routingkey。

2. 生产者将消息发给broker，由交换机根据routingkey来转发消息到指定的队列。

生产者发送若干条消息，交换机根据routingkey统配符匹配并转发消息到指定的队列


- Header

​header模式与routing不同的地方在于，header模式取消routingkey，使用header中的 key/value（键值对）匹配队列。

根据用户的通知设置去通知用户，设置接收Email的用户只接收Email，设置接收sms的用户只接收sms，设置两种通知类型都接收的则两种通知都有效。


- RPC

RPC即客户端远程调用服务端的方法 ，使用MQ可以实现RPC的异步调用，基于Direct交换机实现，流程如下：

1、客户端即是生产者就是消费者，向RPC请求队列发送RPC调用消息，同时监听RPC响应队列。

2、服务端监听RPC请求队列的消息，收到消息后执行服务端的方法，得到方法返回的结果

3、服务端将RPC方法 的结果发送到RPC响应队列

4、客户端（RPC调用方）监听RPC响应队列，接收到RPC调用结果