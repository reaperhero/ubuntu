version: '3'
services:
  nsqadmin:
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
    image: nsqio/nsq:latest
    ports:
      - "4171:4171/tcp"
    container_name: nsqadmin-01
    command: [ "nsqadmin", "--lookupd-http-address=119.3.81.165:4161" ]
  nsqd:
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
    image: nsqio/nsq:latest
    ports:
      - "4150:4150/tcp"
      - "4151:4151/tcp"
    container_name: nsqd-01
    command: [ "nsqd","--lookupd-tcp-address=119.3.81.165:4160","--broadcast-address=119.3.81.165" ]
  nsqlookupd:
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
    image: nsqio/nsq:latest
    ports:
      - "4160:4160/tcp"
      - "4161:4161/tcp"
    container_name: nsqlookupd-01
    command: [ "nsqlookupd" ]
